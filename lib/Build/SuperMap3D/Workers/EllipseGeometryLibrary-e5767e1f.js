define(["exports","./Cartographic-cd471038","./Math-d934ba6b","./FeatureDetection-fb5abd84","./GeometryAttribute-acc7fc74"],(function(o,e,r,a,t){"use strict";var i={},n=new e.o,l=new e.o,y=new t.n,c=new a.p$1;function s(o,r,i,s,u,x,f,h,m,z){var d=o+r;e.o.multiplyByScalar(s,Math.cos(d),n),e.o.multiplyByScalar(i,Math.sin(d),l),e.o.add(n,l,n);var p=Math.cos(o);p*=p;var _=Math.sin(o);_*=_;var v=x/Math.sqrt(f*p+u*_)/h;return t.n.fromAxisAngle(n,v,y),a.p$1.fromQuaternion(y,c),a.p$1.multiplyByVector(c,m,z),e.o.normalize(z,z),e.o.multiplyByScalar(z,h,z),z}var u=new e.o,x=new e.o,f=new e.o,h=new e.o;i.raisePositionsToHeight=function(o,r,a){for(var t=r.ellipsoid,i=r.height,n=r.extrudedHeight,l=a?o.length/3*2:o.length/3,y=new Float64Array(3*l),c=o.length,s=a?c:0,m=0;m<c;m+=3){var z=m+1,d=m+2,p=e.o.fromArray(o,m,u);t.scaleToGeodeticSurface(p,p);var _=e.o.clone(p,x),v=t.geodeticSurfaceNormal(p,h),O=e.o.multiplyByScalar(v,i,f);e.o.add(p,O,p),a&&(e.o.multiplyByScalar(v,n,O),e.o.add(_,O,_),y[m+s]=_.x,y[z+s]=_.y,y[d+s]=_.z),y[m]=p.x,y[z]=p.y,y[d]=p.z}return y};var m=new e.o,z=new e.o,d=new e.o;i.computeEllipsePositions=function(o,a,t){var i=o.semiMinorAxis,n=o.semiMajorAxis,l=o.rotation,y=o.center,c=8*o.granularity,h=i*i,p=n*n,_=n*i,v=e.o.magnitude(y),O=e.o.normalize(y,m),w=e.o.cross(e.o.UNIT_Z,y,z);w=e.o.normalize(w,w);var P=e.o.cross(O,w,d),M=1+Math.ceil(r.e.PI_OVER_TWO/c),g=r.e.PI_OVER_TWO/(M-1),I=r.e.PI_OVER_TWO-M*g;I<0&&(M-=Math.ceil(Math.abs(I)/g));var T,A,E,V,R,W=a?new Array(3*(M*(M+2)*2)):void 0,S=0,b=u,B=x,$=4*M*3,C=$-1,F=0,G=t?new Array($):void 0;for(b=s(I=r.e.PI_OVER_TWO,l,P,w,h,_,p,v,O,b),a&&(W[S++]=b.x,W[S++]=b.y,W[S++]=b.z),t&&(G[C--]=b.z,G[C--]=b.y,G[C--]=b.x),I=r.e.PI_OVER_TWO-g,T=1;T<M+1;++T){if(b=s(I,l,P,w,h,_,p,v,O,b),B=s(Math.PI-I,l,P,w,h,_,p,v,O,B),a){for(W[S++]=b.x,W[S++]=b.y,W[S++]=b.z,E=2*T+2,A=1;A<E-1;++A)V=A/(E-1),R=e.o.lerp(b,B,V,f),W[S++]=R.x,W[S++]=R.y,W[S++]=R.z;W[S++]=B.x,W[S++]=B.y,W[S++]=B.z}t&&(G[C--]=b.z,G[C--]=b.y,G[C--]=b.x,G[F++]=B.x,G[F++]=B.y,G[F++]=B.z),I=r.e.PI_OVER_TWO-(T+1)*g}for(T=M;T>1;--T){if(b=s(-(I=r.e.PI_OVER_TWO-(T-1)*g),l,P,w,h,_,p,v,O,b),B=s(I+Math.PI,l,P,w,h,_,p,v,O,B),a){for(W[S++]=b.x,W[S++]=b.y,W[S++]=b.z,E=2*(T-1)+2,A=1;A<E-1;++A)V=A/(E-1),R=e.o.lerp(b,B,V,f),W[S++]=R.x,W[S++]=R.y,W[S++]=R.z;W[S++]=B.x,W[S++]=B.y,W[S++]=B.z}t&&(G[C--]=b.z,G[C--]=b.y,G[C--]=b.x,G[F++]=B.x,G[F++]=B.y,G[F++]=B.z)}b=s(-(I=r.e.PI_OVER_TWO),l,P,w,h,_,p,v,O,b);var H={};return a&&(W[S++]=b.x,W[S++]=b.y,W[S++]=b.z,H.positions=W,H.numPts=M),t&&(G[C--]=b.z,G[C--]=b.y,G[C--]=b.x,H.outerPositions=G),H},o.C=i}));
